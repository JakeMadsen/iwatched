<%
  // Build animated hero background pattern (tiles + bars)
  const heroBackgroundPattern = [];
  const shimmerDurations = [7.8, 8.6, 9.4, 10.1, 9.2, 8.9];
  function addTileRow(delayStart) {
    for (let i = 0; i < 12; i++) {
      const delay = (delayStart + i * 0.14).toFixed(2) + 's';
      const duration = shimmerDurations[i % shimmerDurations.length].toFixed(1) + 's';
      heroBackgroundPattern.push({ type: 'tile', delay, duration });
    }
  }
  addTileRow(0);
  heroBackgroundPattern.push({ type: 'bar', delay: '0.85s', duration: '12s' });
  addTileRow(1.4);
  heroBackgroundPattern.push({ type: 'bar', delay: '1.7s', duration: '11.4s' });
  addTileRow(2.3);

  const heroMetrics = [
    { label: 'Movies Watched', value: '142' },
    { label: 'Shows Watched', value: '68' },
    { label: 'Total Watch Time', value: '287h' }
  ];

  const featureCards = [
    { key: 'log', title: 'Log Movies & Series', description: 'Build your complete watch history with dates, ratings, and personal notes.', accent: 'blue' },
    { key: 'stats', title: 'Discover Your Stats', description: 'See your top genres, actors, and directors through beautiful visualizations.', accent: 'indigo' },
    { key: 'insights', title: 'Visualize Your Habits', description: 'Learn what kind of viewer you really are with personalized insights.', accent: 'purple' },
    { key: 'customize', title: 'Customize Your Profile', description: 'Unlock showcases, badges, and themes to express your cinematic taste.', accent: 'pink' }
  ];
  function slugify(s){ return String(s||'').toLowerCase().replace(/[^a-z0-9]+/g,'-').replace(/^-+|-+$/g,'').substring(0,80); }

  const trendingMovies = [
    { title: 'Dune: Part Two', image: 'https://images.unsplash.com/photo-1626814026160-2237a95fc5a0?auto=format&fit=crop&w=300&q=80' },
    { title: 'Oppenheimer', image: 'https://images.unsplash.com/photo-1440404653325-ab127d49abc1?auto=format&fit=crop&w=300&q=80' },
    { title: 'Poor Things', image: 'https://images.unsplash.com/photo-1536440136628-849c177e76a1?auto=format&fit=crop&w=300&q=80' },
    { title: 'Killers of the Flower Moon', image: 'https://images.unsplash.com/photo-1517604931442-7e0c8ed2963c?auto=format&fit=crop&w=300&q=80' },
    { title: 'Past Lives', image: 'https://images.unsplash.com/photo-1594909122845-11baa439b7bf?auto=format&fit=crop&w=300&q=80' },
    { title: 'The Zone of Interest', image: 'https://images.unsplash.com/photo-1478720568477-152d9b164e26?auto=format&fit=crop&w=300&q=80' },
    { title: 'Anatomy of a Fall', image: 'https://images.unsplash.com/photo-1485846234645-a62644f84728?auto=format&fit=crop&w=300&q=80' },
    { title: 'The Holdovers', image: 'https://images.unsplash.com/photo-1542204165-65bf26472b9b?auto=format&fit=crop&w=300&q=80' },
    { title: 'The Boy and the Heron', image: 'https://images.unsplash.com/photo-1518834107812-67b0b7c58434?auto=format&fit=crop&w=300&q=80' },
    { title: 'Barbie', image: 'https://images.unsplash.com/photo-1581417478175-a9ef18f210c2?auto=format&fit=crop&w=300&q=80' },
    { title: 'Saltburn', image: 'https://images.unsplash.com/photo-1568876694728-451bbf694b83?auto=format&fit=crop&w=300&q=80' },
    { title: 'Wonka', image: 'https://images.unsplash.com/photo-1634157703702-3c124b455499?auto=format&fit=crop&w=300&q=80' }
  ];
%>

<div class="temp-home" data-page="temp-home">
  <div class="th-main">
    <!-- HERO -->
    <section class="th-section th-hero">
      <div class="th-hero__background" aria-hidden="true">
        <div class="th-hero__gradient"></div>
        <div class="th-hero__poster-grid">
          <% heroBackgroundPattern.forEach(function(item) { %>
            <div class="th-hero__poster <%= item.type === 'bar' ? 'th-hero__poster--bar' : '' %>" style="--delay:<%= item.delay %>;--duration:<%= item.duration %>;"></div>
          <% }); %>
        </div>
        <div class="th-hero__halo th-hero__halo--top" aria-hidden="true"></div>
        <div class="th-hero__halo th-hero__halo--bottom" aria-hidden="true"></div>
      </div>
      <div class="th-shell">
        <div class="th-hero__content">
          <h1 class="th-hero__title">Track. Analyze. Celebrate your movie life.</h1>
          <p class="th-hero__subtitle">Log everything you've watched and discover detailed insights about your viewing habits — from your most-watched genres to your favorite actors.</p>
        </div>
        <div class="th-hero__preview">
          <div class="th-preview-window">
            <div class="th-preview-window__bar">
              <span class="th-preview-dot th-preview-dot--red"></span>
              <span class="th-preview-dot th-preview-dot--yellow"></span>
              <span class="th-preview-dot th-preview-dot--green"></span>
              <span class="th-preview-bar"></span>
            </div>
            <div class="th-preview-window__body">
              <div class="th-preview-window__metrics">
                <% heroMetrics.forEach(function(metric) { %>
                  <div class="th-preview-metric">
                    <strong><%= metric.value %></strong>
                    <span><%= metric.label %></span>
                  </div>
                <% }); %>
              </div>
              <div class="th-preview-window__grid">
                <div class="th-preview-panel th-preview-panel--wide"></div>
                <div class="th-preview-panel"></div>
                <div class="th-preview-panel"></div>
              </div>
            </div>
          </div>
          <span class="th-preview-glow th-preview-glow--one"></span>
          <span class="th-preview-glow th-preview-glow--two"></span>
        </div>
      </div>
    </section>

    <!-- BETA / ANNOUNCEMENT -->
    <section class="th-section th-beta">
      <div class="th-shell">
        <div class="th-beta__inner">
          <span class="th-beta__blob th-beta__blob--one" aria-hidden="true"></span>
          <span class="th-beta__blob th-beta__blob--two" aria-hidden="true"></span>
          <div class="th-beta__icon" aria-hidden="true">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <circle cx="12" cy="12" r="10"></circle>
              <path d="M12 8v4l3 3"></path>
            </svg>
          </div>
          <div class="th-beta__content">
            <h3>
              <span data-ann-title>iWatched BETA Access</span>
              <span class="th-badge th-badge--inline" data-ann-date style="display:none;"></span>
            </h3>
            <p class="th-beta__lead" data-ann-text>We’re working in the open. Expect rapid updates and occasional sharp edges while we refine the experience.</p>
            <div class="th-beta__note"><a class="th-link" data-ann-link href="/announcements">Read the latest announcement</a></div>
          </div>
        </div>
      </div>
    </section>

    <!-- FEATURES -->
    <section class="th-section th-features" id="features">
      <div class="th-shell">
        <div class="th-section__heading">
          <h2>Your movie journey, enhanced</h2>
          <p>iWatched transforms how you track, remember, and share your entertainment experiences.</p>
        </div>
        <div class="th-feature-grid">
          <% featureCards.forEach(function(feature) { %>
            <a class="th-feature-card th-feature-card--<%= feature.accent %>" href="/about#<%= slugify(feature.title) %>">
              <div class="th-feature-card__icon">
                <% if (feature.key === 'log') { %>
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <rect x="2" y="4" width="20" height="16" rx="2"></rect>
                    <path d="M16 2v4"></path>
                    <path d="M8 2v4"></path>
                    <path d="M2 10h20"></path>
                  </svg>
                <% } else if (feature.key === 'stats') { %>
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M3 3v18h18"></path>
                    <rect x="7" y="13" width="3" height="5" rx="1"></rect>
                    <rect x="12" y="9" width="3" height="9" rx="1"></rect>
                    <rect x="17" y="5" width="3" height="13" rx="1"></rect>
                  </svg>
                <% } else if (feature.key === 'insights') { %>
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M3.73 7.11a7.92 7.92 0 0 1 2.08-2.52"></path>
                    <path d="M2.05 13a8 8 0 0 1 4.5-10.9"></path>
                    <path d="M11 2a8 8 0 0 1 11 6"></path>
                    <path d="M21.95 11.05a8 8 0 0 1-4.5 10.9"></path>
                    <path d="M13 22a8 8 0 0 1-11-6"></path>
                    <circle cx="12" cy="12" r="3"></circle>
                  </svg>
                <% } else { %>
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M21 3v18"></path>
                    <path d="M4 21a8 8 0 0 0 8-8"></path>
                    <path d="M4 3v18"></path>
                    <path d="M9 3h10"></path>
                    <path d="M9 21h10"></path>
                  </svg>
                <% } %>
              </div>
              <h3><%= feature.title %></h3>
              <p><%= feature.description %></p>
              <div class="th-feature-card__cta">
                Learn more
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                  <polyline points="9 18 15 12 9 6"></polyline>
                </svg>
              </div>
            </a>
          <% }); %>
        </div>
      </div>
    </section>

    <!-- TRENDING: use TMDb popular movies/shows (6 each) until we have site data -->
    <section class="th-section th-trending">
      <div class="th-shell">
        <div class="th-trending__head th-trending__head--center">
          <h2>Trending Among iWatched Users</h2>
        </div>
        <!-- Movies row -->
        <div class="th-trending__grid">
          <% ((page_data && page_data.popular && page_data.popular.movies) || []).slice(0,6).forEach(function(movie){ %>
            <a class="th-movie-card" href="/movies/<%= movie.id %>-<%= (movie.title||'').toLowerCase().replace(/[^a-z0-9]+/g,'-').replace(/^-+|-+$/g,'').substring(0,80) %>">
              <div class="th-movie-card__media"><img src="https://image.tmdb.org/t/p/w500/<%= movie.poster_path %>" alt="<%= movie.title %> poster"></div>
              <div class="th-movie-card__overlay"><h3><%= movie.title %></h3></div>
            </a>
          <% }); %>
        </div>
        <!-- Shows row -->
        <div class="th-trending__grid" style="margin-top:18px;">
          <% ((page_data && page_data.popular && page_data.popular.shows) || []).slice(0,6).forEach(function(show){ %>
            <a class="th-movie-card" href="/shows/<%= show.id %>-<%= (show.name||'').toLowerCase().replace(/[^a-z0-9]+/g,'-').replace(/^-+|-+$/g,'').substring(0,80) %>">
              <div class="th-movie-card__media"><img src="https://image.tmdb.org/t/p/w500/<%= show.poster_path %>" alt="<%= show.name %> poster"></div>
              <div class="th-movie-card__overlay"><h3><%= show.name %></h3></div>
            </a>
          <% }); %>
        </div>
      </div>
    </section>
  </div>
</div>

<div id="profile_lists">
    <div id="profile_movie_list">
        <div name="allMovies" class="row">
            <h3 class="col-md-6" style="text-align: left;">
                <% if ((page_data.type||'movies') === 'shows') { %>
                    All shows I've seen
                <% } else { %>
                    All movies I've seen
                <% } %>
            </h3>
            <div class="col-md-6" style="text-align: right;">
                <% if ((page_data.type||'movies') === 'shows') { %>
                    <label for="shows_sort_select" style="margin-right:8px;">Sort:</label>
                    <select id="shows_sort_select" class="custom-select custom-select-sm" style="width:auto; display:inline-block;">
                        <option value="" selected>Default (A→Z)</option>
                        <option value="seasons_desc">Seasons: many → few</option>
                        <option value="seasons_asc">Seasons: few → many</option>
                        <option value="first_air_desc">First air date: new → old</option>
                        <option value="first_air_asc">First air date: old → new</option>
                    </select>
                <% } %>
                <span style="margin-left:12px;">Amount: <%= page_data.amountOfMovies %></span>
            </div>
        </div>

        <div id="movies_holder" class="row">

        </div>

        <div id="view_more" style="display: none;">
            <div class="page-load-status">
                <div class="loader-ellips infinite-scroll-request">
                    <span class="loader-ellips__dot"></span>
                    <span class="loader-ellips__dot"></span>
                    <span class="loader-ellips__dot"></span>
                    <span class="loader-ellips__dot"></span>
                </div>
                <p class="infinite-scroll-last">End of content</p>
                <p class="infinite-scroll-error">No more pages to load</p>
            </div>

            <p><button type="button" class="btn btn-primary  view-more-button">View more</button></p>
        </div>
    </div>
    <!-- List all items -->
</div>

<script>
    document.addEventListener("DOMContentLoaded", function (event) {
        if ('<%= page_data.type||'movies' %>' === 'shows') {
            var sel = document.getElementById('shows_sort_select');
            function run(){
                var sort = sel ? sel.value : '';
                $('#movies_holder').empty();
                profileWatchedShows('<%= page_data.user._id%>', sort);
            }
            if (sel) sel.addEventListener('change', run);
            run();
        }
        else { profileWatchedMovies('<%= page_data.user._id%>'); }
    });
</script>

<% if ((page_data.type||'movies') === 'shows') { %>
    <% include show_template.ejs %>
<% } else { %>
    <% include movie_template.ejs %>
<% } %>
